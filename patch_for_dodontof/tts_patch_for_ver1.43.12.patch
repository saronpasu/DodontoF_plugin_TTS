diff -crN DodontoF_tts/DodontoFServer.rb DodontoF_org/DodontoFServer.rb
*** DodontoF_tts/DodontoFServer.rb	2014-03-10 17:50:36.381813000 +0900
--- DodontoF_org/DodontoFServer.rb	2014-03-08 16:36:10.000000000 +0900
***************
*** 820,828 ****
        ['changeEffectsAll', hasNoReturn], 
        ['removeEffect', hasNoReturn], 
        ['changeImageTags', hasNoReturn], 
-       
-       ['createTTS', hasReturn],
-       ['deleteTTS', hasReturn],
      ]
      
      commands.each do |command, commandType|
--- 820,825 ----
***************
*** 6473,6483 ****
      #é€šå¸¸ã®ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼
      main(cgiParams)
    end
- 
-   if( $useOpenJTalk == true )
-     # TTS ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’èª­ã¿è¾¼ã‚€
-     require 'DodontoFServerTTS.rb'
-   end
    
  end
    
--- 6470,6475 ----
diff -crN DodontoF_tts/src_ruby/config.rb DodontoF_org/src_ruby/config.rb
*** DodontoF_tts/src_ruby/config.rb	2014-03-10 17:50:02.389813000 +0900
--- DodontoF_org/src_ruby/config.rb	2014-03-08 16:36:44.000000000 +0900
***************
*** 187,195 ****
  #ã‚ã€ã‚ã¨PHPç’°å¢ƒå¿…é ˆãªã‚“ã§ãã®è¾ºã¯é ‘å¼µã£ã¦ä¸‹ã•ã„ã€‚
  $canTalk = true
  
- #èª­ã¿ä¸Šã’æ©Ÿèƒ½(Open JTalkç‰ˆ)ã®æœ‰åŠ¹ï¼ç„¡åŠ¹(true/false)ã€‚ã‚µãƒ¼ãƒã«è² è·ãŒæ›ã‹ã‚‹ã®ã§æœ‰åŠ¹åŒ–ã¯æ…é‡ã«
- $useOpenJTalk = true
- 
  #å·®åˆ†è¨˜éŒ²æ–¹å¼ã§ä¿å­˜ã™ã‚‹ä¿å­˜ä»¶æ•°
  $recordMaxCount = 5
  
--- 187,192 ----
diff -crN DodontoF_tts/talkerProxy.php DodontoF_org/talkerProxy.php
*** DodontoF_tts/talkerProxy.php	2014-03-10 19:20:07.781904000 +0900
--- DodontoF_org/talkerProxy.php	2012-11-23 16:19:27.000000000 +0900
***************
*** 1,106 ****
! <?php
! 
! date_default_timezone_set('Asia/Tokyo');
! mb_internal_encoding("UTF-8");
! mb_regex_encoding('UTF-8');
! 
! $queryText = (isset($_POST['queryText']) && $_POST['queryText']) ? $_POST['queryText'] : 'undefined';
! 
! $url_replaced = $queryText;
! 
! if($url_replaced == 'undefined'){ print ''; exit; }
! 
! $url_replaced_decoded   = urldecode($url_replaced);
! 
! // å›ºæœ‰åè©ç½®æ›
! // Elysioné–¢é€£
! $url_replaced_decoded = preg_replace('/elysion/i',' ãˆã‚Šã‚…ã—ãŠã‚“ ',$url_replaced_decoded);
! 
! $url_replaced_decoded = preg_replace('/ã€Œ/ui','ãƒ»',$url_replaced_decoded);
! $url_replaced_decoded = preg_replace('/ã€/ui','ãƒ»',$url_replaced_decoded);
! $url_replaced_decoded = preg_replace('/^ï¼š(Â¥d+) Â¥((Â¥d+D%*Â¥d+).*/',' ã ã„ã™ã‚ãƒ¼ã‚‹ãƒ»$2ãƒ»åˆè¨ˆãƒ»$1 ',$url_replaced_decoded);
! $url_replaced_decoded = preg_replace('/^ï¼š+/ui','',$url_replaced_decoded);
! $url_replaced_decoded = preg_replace('/([^a-zA-Zï½-ï½šï¼¡-ï¼º])[wï½—]+$/ui','$1ãƒ»ã‚ã‚‰ ',$url_replaced_decoded);
! $url_replaced_decoded = preg_replace('/([^a-zA-Zï½-ï½šï¼¡-ï¼º])[wï½—]{2,}/ui','$1ãƒ»',$url_replaced_decoded);
! $url_replaced_decoded = preg_replace('/[Â¥.ã€‚ï¼ãƒ»â€¦]{2,}/ui','ãƒ»',$url_replaced_decoded);
! $url_replaced_decoded = preg_replace('/â€¦/ui','ãƒ»',$url_replaced_decoded);
! $url_replaced_decoded = preg_replace('/(ftp|http|https)Â¥:Â¥/Â¥/.*/ui','ãƒ»$1ã®urlã§ã™ãƒ»',$url_replaced_decoded);
! 
! // è¾æ›¸ç³»
! $url_replaced_decoded = preg_replace('/â†‘/ui','ãƒ»ã†ãˆãƒ»',$url_replaced_decoded);
! $url_replaced_decoded = preg_replace('/â†“/ui','ãƒ»ã—ãŸãƒ»',$url_replaced_decoded);
! $url_replaced_decoded = preg_replace('/â†/ui','ãƒ»ã²ã ã‚Šãƒ»',$url_replaced_decoded);
! $url_replaced_decoded = preg_replace('/â†’/ui','ãƒ»ã¿ããƒ»',$url_replaced_decoded);
! $url_replaced_decoded = preg_replace('/æ¬ ç‰‡/ui','ã‹ã‘ã‚‰',$url_replaced_decoded);
! $url_replaced_decoded = preg_replace('/SANãƒã‚§ãƒƒã‚¯/ui','ã•ã‚“ã¡ã‡ã£ã',$url_replaced_decoded);
! $url_replaced_decoded = preg_replace('/ï¼³ï¼¡ï¼®ãƒã‚§ãƒƒã‚¯/ui','ã•ã‚“ã¡ã‡ã£ã',$url_replaced_decoded);
! $url_replaced_decoded = preg_replace('/ç™¾åˆå±•é–‹/ui','ãã¾ã—ãŸã‚ãƒ¼',$url_replaced_decoded);
! $url_replaced_decoded = preg_replace('/ç™¾åˆ/ui','ã‚†ã‚Š',$url_replaced_decoded);
! $url_replaced_decoded = preg_replace('/ktkr/ui','ããŸã“ã‚Œ',$url_replaced_decoded);
! $url_replaced_decoded = preg_replace('/ï½‹ï½”ï½‹ï½’/ui','ããŸã“ã‚Œ',$url_replaced_decoded);
! $url_replaced_decoded = preg_replace('/ksk/ui','ã‹ãã',$url_replaced_decoded);
! $url_replaced_decoded = preg_replace('/ï½‹ï½“ï½‹/ui','ã‹ãã',$url_replaced_decoded);
! $url_replaced_decoded = preg_replace('/æ™¶çŸ³/ui','ã—ã‚‡ã†ã›ã',$url_replaced_decoded);
! 
! $fp = fopen('tts.txt', 'w');
! fwrite($fp ,$url_replaced_decoded);
! 
! $referer = $_SERVER["HTTP_REFERER"];
! $tts_url = preg_replace('/DodontoFÂ¥.swf/ui', '', $referer);
! $webif_url = preg_replace('/Â¥.swf/ui', 'Server.rb',$referer);
! 
! $data = array(
!     'webif' => 'createTTS',
!     'input_file' => 'tts.txt',
!     'output_file' => 'tts.wav',
! );
! $headers = array(
!     'User-Agent: Mozilla/5.5'
! );
! $options = array('http' => array(
!     'method' => 'POST',
!     'content' => http_build_query($data),
!     'header' => implode("Â¥rÂ¥n", $headers),
! ));
! $contents = file_get_contents($webif_url, false, stream_context_create($options));
! 
! $data_url = $tts_url . "tts.wav";
! 
! $options = array('http' => array(
!     'method' => 'GET',
!     'content' => http_build_query($data),
!     'header' => implode("Â¥rÂ¥n", $headers),
! ));
! 
! $context = stream_context_create($option);
! $fp = fopen($data_url, 'r', false, $context);
! fpassthru($fp);
! fclose($fp);
! 
! $data = array(
!     'webif' => 'deleteTTS',
!     'target_file' => 'tts.txt',
! );
! 
! $options = array('http' => array(
!     'method' => 'POST',
!     'content' => http_build_query($data),
!     'header' => implode("Â¥rÂ¥n", $headers),
! ));
! 
! $contents = file_get_contents($webif_url, false, stream_context_create($options));
! 
! $data = array(
!     'webif' => 'deleteTTS',
!     'target_file' => 'tts.wav',
! );
! 
! $options = array('http' => array(
!     'method' => 'POST',
!     'content' => http_build_query($data),
!     'header' => implode("Â¥rÂ¥n", $headers),
! ));
! 
! $contents = file_get_contents($webif_url, false, stream_context_create($options));
! 
! ?>
--- 1,16 ----
! <?php
! $queryText = (isset($_POST['queryText']) && $_POST['queryText']) ? $_POST['queryText'] : 'undefined';
! $url = "http://translate.google.com/translate_tts?tl=ja&q=" . $queryText;
! 
! $option = array(
!     'http'=>array(
!         'method'=>"GET",
!         'header' => "User-Agent:Mozilla/5.5\r\n". //Mozilla‚ğw’è
!                     "Content-type: application/x-www-form-urlencoded\r\n".
!                     "Accept-Language: ja-jp,en;q=0.5\r\n".
!                     "Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7" ));
! $context = stream_context_create($option);
! $fp = fopen($url, 'r', false, $context);
! fpassthru($fp);
! fclose($fp);
! ?>
